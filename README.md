# XPath 题库工具集

一套强大的浏览器用户脚本工具集，用于 XPath 元素选择和题库提取。

## 📦 包含工具

### 1. XPath 元素选择器 (`xpath-selector.user.js`)
智能的 XPath 选择工具，支持：
- ✨ 实时元素高亮
- 🎯 单个元素 XPath 获取
- 🧠 智能相似元素 XPath 生成
- 📋 XPath 循环模板生成
- 💡 JavaScript 代码建议
- 🔍 批量元素操作（点击、高亮、获取文本）

### 2. 题库提取器 (`question-extractor.user.js`)
专业的题库提取工具，支持：
- 📝 题目与选项智能提取
- 🎓 支持 A/B/C/D/E/F/H 多种选项类型
- 💾 答案自动提取
- 📊 导出 Excel (.xlsx)
- 📄 导出 JSON、文本格式
- 🔄 自动 XPath 模板循环

## 🚀 安装使用

### 前置要求
- Chrome/Edge/Firefox 浏览器
- 安装 [Tampermonkey](https://www.tampermonkey.net/) 或 [Violentmonkey](https://violentmonkey.github.io/) 扩展

### 安装步骤
1. 点击脚本文件，在 GitHub 查看完整代码
2. 点击 "Raw" 或 "Download" 按钮
3. Tampermonkey 会自动提示是否安装，点击"安装"即可
4. 安装完成后，页面右上角会显示扩展图标

## 📖 使用指南

### XPath 元素选择器

1. **打开工具**：点击页面右下角的 ⚡ 按钮
2. **选择元素**：
   - 点击 1 个元素：获取该元素的完整 XPath
   - 点击 2 个相似元素：智能生成匹配所有相似元素的 XPath
3. **查看结果**：自动显示匹配的元素数量和列表
4. **批量操作**：可对匹配的所有元素进行点击、高亮、获取文本等操作
5. **复制代码**：获取 JavaScript 循环代码建议，直接使用

### 题库提取器

1. **打开工具**：点击页面右下角的 📚 按钮
2. **选择题目**：点击"选择题目"按钮，然后在页面上选择 2 个题目元素
3. **选择选项**：分别选择 A、B、C、D（可选 E、F、H）选项，每个选项选择 2 次
4. **选择答案**（可选）：如需要提取答案，点击"选择答案"按钮
5. **提取题库**：点击"提取题库"按钮
6. **导出数据**：选择导出格式（Excel/JSON/文本）

## ✨ 核心特性

### 智能 XPath 生成
- 自动识别元素结构
- 生成最通用的 XPath 表达式
- 支持 `{i}` 占位符循环
- 自动简化路径（去除 /html/body 前缀）

### 题库提取优化
- 自动处理多选项混排
- 智能识别题目容器
- 支持答案自动提取
- 导出 Excel 无序号列，自动调整列宽

### 用户体验
- 实时鼠标悬停高亮
- 模式指示器提示
- 调试信息输出
- 一键复制功能

## 🎯 使用场景

- 📚 在线考试题库整理
- 📖 学习资料提取
- 📝 题目批量处理
- 🔍 XPath 学习和调试
- 🤖 自动化脚本开发

## 📝 注意事项

1. **本地文件**：脚本支持 `file://` 协议，可在本地 HTML 文件使用
2. **调试模式**：打开浏览器控制台可查看详细调试信息
3. **Excel 导出**：首次使用需加载 XLSX 库，请确保网络连接正常
4. **元素筛选**：自动排除脚本 UI 元素，避免误选

## 🛠️ 技术栈

- **JavaScript**：原生 JS，无依赖
- **XPath**：DOM 路径查询
- **SheetJS**：Excel 文件生成
- **Tampermonkey**：用户脚本管理

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 📞 反馈

如有问题或建议，请在 GitHub Issues 中反馈。

